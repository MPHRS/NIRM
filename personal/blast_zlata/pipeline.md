## Методы

### Поиск взаимных ортологов (RBH)

Для определения гомологичных белков между организмами был проведён BLASTp-анализ всех против всех. Белковые последовательности (файлы `protein.faa`) находились в отдельных подкаталогах папки `data`. Скрипт `blastp.sh` создавал BLAST-базы (`makeblastdb`) и запускал попарные сравнения с параметрами: `evalue 1e-5`, `outfmt 6`, `num_threads 4`. Результаты сохранялись в директорию `blast_results`.

Далее с помощью скрипта `filter.sh` для каждого результата BLAST отбирался только первый (наиболее значимый) хит для каждого белка:

```bash
awk '!seen[$1]++'
```

Скрипт `rbh.py` затем определял **взаимные лучшие хиты** (*Reciprocal Best Hits*, RBH): если белок A из организма X имеет наилучший хит к белку B из организма Y, и наоборот — пара (A, B) записывалась как RBH. Все такие пары сохранялись в `reciprocal_best_hits.txt`.

### Кластеризация и выделение ортогрупп

Для построения ортогрупп использовался алгоритм MCL (Markov Cluster Algorithm). Входные данные готовились на основе RBH-пар с помощью скрипта `results.py`, а выходные ортогруппы сохранялись в файлы `orthogroups.txt` и `orthogroups.mcl`.

Скрипт `extract_orthogroups.py` извлекал белковые последовательности каждой ортогруппы и сохранял их в отдельные FASTA-файлы в директории `orthogroup_fastas`.

### Множественное выравнивание и тримминг

Выравнивание белков внутри ортогрупп проводилось с помощью **MAFFT** (`--auto`) через скрипт `process_orthogroups.sh`. Результаты сохранялись в директорию `aligned`.

Далее выравнивания очищались от неинформативных или слабо выровненных позиций с помощью **trimAl** (`-automated1`). Триммированные выравнивания сохранялись в `trimmed`.

### Конкатенация и построение филогенетического дерева

Для построения филогенетического дерева были выбраны пять наиболее вариабельных ортогрупп (отбор проводился вручную, на основе визуальной оценки или распределения длины/различий). Триммированные выравнивания этих групп были объединены в общий суперматрикс с помощью встроенного Python-скрипта внутри `process_orthogroups.sh`. Конкатенация проводилась по идентификатору генома до первой точки (например, `GCA_...`), пропущенные последовательности заменялись gap-ами (`---`).

Финальное выравнивание (`concatenated_alignment.faa`) использовалось для построения дерева с помощью **FastTree** с моделью замещения LG:

```bash
FastTree -lg concatenated_alignment.faa > tree.nwk
```

Итоговое дерево в файле `tree.nwk`.
